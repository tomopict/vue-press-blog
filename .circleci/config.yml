version: 2
jobs:
  build:
    docker:
      - image: circleci/node:12-browsers
    steps:
      # - run:
      #       name: Update ChromeDriver Version
      #       command: |
      #         CHROME_VERSION=$(google-chrome --version | sed -r 's/[^0-9]+([0-9]+\.[0-9]+\.[0-9]+).*/\1/g')
      #         CHROMEDRIVER_VERSION=$(curl -s https://chromedriver.storage.googleapis.com/LATEST_RELEASE_$CHROME_VERSION)
      #         bundle exec chromedriver-update $CHROMEDRIVER_VERSION
      - run:
          name: Install lighthouse
          command: |
            sudo npm install -g lighthouse
      - run:
          name: Check lighthouse
          command: |
            lighthouse --version
      - run:
          name: Run lighthouse
          command: |
            lighthouse https://tomopict.netlify.com/ --save-assets
      - store_artifacts:
          path: '.'

workflows:
  version: 2
  build_and_test:
    jobs:
      - build